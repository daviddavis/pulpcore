Fixed race condition where a task could clean up reserved resources shared with another task.
